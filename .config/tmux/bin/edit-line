#!/bin/sh

# This is a sh+vim rewrite of ./edit-line.py, in case python is not available.

# intro:
#
#   global `<C-x><C-e>` (readline editor / zsh zle)
#
# usage:
#
#   # add to tmux.conf (modify key / path accordingly):
#   bind -n M-e run ~/.config/tmux/bin/edit-line

set -e

s=$(mktemp)
tmux popup -E \
    vim -S ~/vimfiles/bin/edit-line.vim -- "$s"

line=$(cat -- "$s")
rm -- "$s"

if [ -n "$line" ]; then
    tmux send -l -- "$line"
fi
