# vim:fdm=marker
# setting {{{1
%if "#{==:${TERM},linux}"
    set -g default-terminal "linux"
%else
    set-option -sa terminal-overrides ",${TERM}:RGB"
    %if "#{==:${TERM},alacritty}"
        set -g default-terminal "alacritty"
    %elif  "#{==:${TERM},xterm-kitty}"
        set -g default-terminal "xterm-kitty"
    %else
        set -g default-terminal "tmux-256color"
    %endif
%endif

# non-login shell
set -g default-command zsh

# set $EDITOR to vim in case of not set in shell rc
setenv -g EDITOR vim

# pane index begin with 1
set -g base-index 1
setw -g pane-base-index 1

# change interval
set -g status-interval 1

# simple ui
set -g status-left '[#S] '
set -g status-left-length 20
set -g status-right '[%Y-%m-%d %H:%M UTC%z]'
set -g status-style 'bg=default,bold'
setw -g window-status-current-style 'bg=cyan,bold fg=white'

# escape time
set -s escape-time 0

# clipboard
set -g set-clipboard on

# change prefix (from c-b to c-s); some vi keys

set -g prefix C-s
unbind C-b
bind C-s send-prefix

# select window / pane {{{1
bind h selectp -L
bind j selectp -D
bind k selectp -U
bind l selectp -R

# send M-hjkl to pane if zoomed or only one pane in window.
bind -n M-h if-shell -F '#{||:#{==:#{window_panes},1},#{==:#{window_zoomed_flag},1}}' 'send M-h' 'selectp -L'
bind -n M-j if-shell -F '#{||:#{==:#{window_panes},1},#{==:#{window_zoomed_flag},1}}' 'send M-j' 'selectp -D'
bind -n M-k if-shell -F '#{||:#{==:#{window_panes},1},#{==:#{window_zoomed_flag},1}}' 'send M-k' 'selectp -U'
bind -n M-l if-shell -F '#{||:#{==:#{window_panes},1},#{==:#{window_zoomed_flag},1}}' 'send M-l' 'selectp -R'

bind -n M-n selectw -n
bind -n M-p selectw -p

# create pane {{{1
bind c neww -c '$HOME'
bind C neww -c '#{pane_current_path}'
bind s splitw -v -c '$HOME'
bind S splitw -v -c '#{pane_current_path}'
bind v splitw -h -c '$HOME'
bind V splitw -h -c '#{pane_current_path}'

# misc {{{1
bind u run ~/bin/tmux-url-select.pl

bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy > /dev/null"
bind C-v run "pbpaste | tmux load-buffer - ; tmux paste-buffer"

bind w choose-session -Z
