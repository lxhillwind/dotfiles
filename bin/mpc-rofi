#!/bin/sh

# select song to play (mpd / mpc) with fzf / rofi

# fzf
if [ -t 1 ]; then
    selected=$(mpc -f "%position%) %artist% - %title%" playlist | fzf --tac)
    if [ -z "$selected" ]; then
        exit 0
    fi
    num=$(printf "%s" "$selected" | sed -n 's/^\([0-9]\+\)).*/\1/p')
    if [ -n "$num" ]; then
        mpc -q play "$num"
    fi
    exit 0
fi

# rofi
if [ $# -eq 0 ]; then
    printf "\0message\x1fNow playing: <b>%s</b>\n" "$(mpc -f "%artist% - %title%" status | head -n 1)"
    mpc -f "%position%) %artist% - %title%" playlist
else
    num=$(printf "$*" | sed -n 's/^\([0-9]\+\)).*/\1/p')
    if [ -n $num ]; then
        mpc -q play "$num"
    fi
fi
