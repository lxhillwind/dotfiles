#!/bin/sh

set -e

err()
{
    printf 'not implemented: %s\n' "$*"
    exit 1
}

basename=${0##*/}

if [ -n "$VM_USING_VIRTUALBOX" ] || ! [ -f ~/qemu/config ]; then
    case "$basename" in
        vm-list)
            exec VBoxManage list vms ;;
        vm-start)
            exec VBoxManage startvm "$@" ;;
        *)
            err "$basename" ;;
    esac

else
    case "$basename" in
        vm-list)
            grep -Ewo '^\s+[a-zA-Z0-9_-][^: ]*\)$' ~/qemu/config | tr -d ')' ;;
        vm-start)
            exec launch-qemu "$@" ;;
        *)
            err "$basename" ;;
    esac
fi
